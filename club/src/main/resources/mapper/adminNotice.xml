<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="adminNotice">
	<select id="adminNoticeList" resultType="admin.AdminVO" parameterType="admin.AdminVO">
		SELECT * FROM project.adminnotice
		<where>
			<if test="keyword != null and keyword != ''">
				notice_name like '%${keyword}%' OR notice_num like '%${keyword}%' OR notice_subject like '%${keyword}%'
			</if>
		</where>
		ORDER BY notice_re_ref DESC ,notice_re_seq ASC 
		limit #{startIndex},#{limit}
	</select>
	
	<select id="count" resultType="integer" parameterType="admin.AdminVO">
		SELECT count(*) FROM project.adminnotice
		<where>
			<if test="keyword != null and keyword != ''">
				notice_name like '%${keyword}%' OR notice_num like '%${keyword}%' OR notice_subject like '%${keyword}%'
			</if>
		</where>
	</select>
	
	<insert id="adminNoticeInsert" parameterType="admin.AdminVO">
		INSERT INTO project.adminnotice
		(notice_name, notice_subject, notice_content, notice_file, notice_re_ref, notice_re_lev, notice_re_seq, notice_readcount, notice_date)
		VALUES
		( #{notice_name},  #{notice_subject}, #{notice_content}, #{notice_file}, #{notice_re_ref}, 0, 0, 0, now())
	</insert>	
	
	<select id="maxNoticeNum" resultType="integer">
		SELECT max(notice_num) + 1 FROM project.adminnotice
	</select>
	
	<select id="adminNoticeView" resultType="admin.AdminVO" parameterType="integer">
		SELECT * FROM project.adminnotice WHERE notice_num = #{notice_num}
	</select>
	
	<update id="adminNoticeUpdate" parameterType="admin.AdminVO">
		UPDATE project.adminnotice SET
		notice_subject=#{notice_subject}, notice_content=#{notice_content}
		<if test="notice_file != null">
			, notice_file=#{notice_file}
		</if>
		WHERE notice_num=#{notice_num}
	</update>
	
	<delete id="adminNoticeDelete" parameterType="integer">
		DELETE FROM project.adminnotice WHERE notice_num=#{notice_num}
	</delete>
	
	<update id="updateReadcount" parameterType="integer">
		UPDATE project.adminnotice SET notice_readcount = notice_readcount+1 WHERE notice_num=#{notice_num}
	</update>
	
	<select id="writerCheck" parameterType="admin.AdminVO">
		SELECT * FROM project.adminnotice WHERE notice_num=#{notice_num}
	</select>	
</mapper>